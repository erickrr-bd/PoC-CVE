/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 */

package com.tekium.log4j2vuln;

import java.io.IOException;
import java.net.InetSocketAddress;
import org.apache.logging.log4j.Logger;
import com.sun.net.httpserver.HttpServer;
import org.apache.logging.log4j.LogManager;

/**
 *
 * @author Erick Roberto Rodriguez Rodriguez
 */
public class Log4j2Vuln {
    
    static Logger log = LogManager.getLogger("Log4j2Vuln");

    public static void main(String[] args) throws IOException {
        System.out.println("   ..####...##..##..######...........####....####....####.....##................##......##...####....####....####..\n" + "   .##..##..##..##..##..................##..##..##......##...###............##..##..##..##......##......##..##..##.\n" + "   .##......##..##..####....######...####...######...####.....##....######..######..######...####....####....####..\n" + "   .##..##...####...##..............##......##..##..##........##................##......##..##......##......##..##.\n" + "   ..####.....##....######..........######...####...######..######..............##......##..######..######...####..\n" + "   By Erick Rodriguez\n" + "\n");
        log.info("Author: Erick Roberto Rodriguez Rodriguez");
        log.info("Email: erodriguez@tekium.mx, erickrr.tbd93@gmail.com");
        log.info("GitHub: https://github.com/erickrr-bd/PoC-CVE");
        log.info("CVE-2021-44228 - June 2025");
        log.info("Starting Log4j2Vuln using Java 1.8.0 and Log4j2 2.11.2");
        log.info("Server listening on port: 8080");
        HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);
        server.createContext("/", new Log4j2Vuln_Handler());
        server.setExecutor(null);
        server.start();
    }
}
