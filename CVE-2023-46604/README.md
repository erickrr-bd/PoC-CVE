# CVE-2023-46604

Proof of concept (PoC) for the CVE-2023-46604 vulnerability affecting Apache ActiveMQ. This vulnerability allows remote code execution (RCE) due to insecure deserialization in the OpenWire protocol.

## Description

The Java OpenWire protocol marshaller is vulnerable to Remote Code Execution. This vulnerability may allow a remote attacker with network access to either a Java-based OpenWire broker or client to run arbitrary shell commands by manipulating serialized class types in the OpenWire protocol to cause either the client or the broker (respectively) to instantiate any class on the classpath. 

For more information:

[CVE-2023-46604](https://nvd.nist.gov/vuln/detail/CVE-2023-46604)

## Requirements
- Python 3.x (Tested with Python 3.12)
- Vulnerable version of Apache ActiveMQ (Tested with Apache ActiveMQ 5.16.4)
- Connection between the victim machine and the attacker's machine

# Running

As a first step, it's required to assign execution permissions to the py file that corresponds to the exploit.

```
chmod +x cve_2023_46604.py
```

```
usage: ./cve_2023_46604.py [-i] [-p] [-u]

arguments:
  -i, --ip      Apache ActiveMQ server IP
  -p, --port       Apache ActiveMQ server port (default: "61616")
  -u, --url      Spring XML URL
```

Similarly, execution permissions must be given to the py file that creates an HTTP server.

```
chmod +x http_server.py
```

```
usage: ./http_server.py [-p]

arguments:
  -p, --port       HTTP server port (default: "80")
```

## Credits

This project is based on the [evkl1d](https://github.com/evkl1d/CVE-2023-46604) exploit.

## Disclaimer

This project is intended for educational purposes and testing ethical hacking (always do so with prior authorization or in your own controlled testing environment). The author is not responsible for any malicious use or damage caused. Use at your own risk.
